"use strict";const o=require("electron"),s=require("path"),l=require("electron").ipcMain,d=require("electron").dialog,t=require("fs");l.on("open-save-chart-dialog",async function(e){let n=await d.showSaveDialog({title:"保存数据",defaultPath:"/",filters:[{name:"text",extensions:["txt"]},{name:"excel",extensions:["csv"]}]});e.sender.send("save-finished",n),n.filePath});l.on("asynchronous-message",function(e,n){let i=s.join(__dirname,"../renderer/data/data.json");t.access(i,t.constants.F_OK,a=>{a?e.sender.send("asynchronous-reply","创建失败"+a):t.writeFile(i,n,"utf8",r=>{r?e.sender.send("asynchronous-reply","写入失败"+r):e.sender.send("asynchronous-reply","写入成功")})})});const c=()=>{const e=new o.BrowserWindow({webPreferences:{contextIsolation:!1,nodeIntegration:!0}});e.webContents.openDevTools(),e.setMenu(null),process.env.NODE_ENV==="development"?e.loadURL(process.env.VITE_DEV_SERVER_URL):e.loadFile(s.join(__dirname,"../dist/index.html"));const n=new o.BrowserWindow({width:800,height:600,webPreferences:{preload:s.join(__dirname,"preload.js"),nodeIntegration:!0,contextIsolation:!1}});process.env.NODE_ENV==="development"?n.loadFile("public/mqtt/index.html"):n.loadFile(s.join(__dirname,"../dist/mqtt/index.html"))};o.app.whenReady().then(c);
